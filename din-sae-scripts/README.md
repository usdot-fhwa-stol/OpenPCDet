# DIN SAE Scripts

This folder contains scripts used to evaluate the DIN SAE Automotive LiDAR specification on KITTI-formatted LiDAR data.
These include:
- `cvat_to_openpcdet.py`: Used to convert annotations from the Datamuro format exported by [CVAT](https://www.cvat.ai/post/3d-point-cloud-annotation) to the KITTI 3D Object dataset format. This includes:
  1. `velodyne/`: LiDAR data in `.bin` format
  2. `label_2/`: Bounding box information
  3. `image_2/`: A camera image of the scene (since there are no images in the provided dataset, these are all black)
  4. `calib/`: Transformation matrices for going from LiDAR to camera coordinates

  Usage: `python3 cvat_to_openpcdet.py {pcd_path} {json_path} {params_path} {dataset_root}`
    1. `pcd_path`: Path to directory containing PCD files
    2. `json_path`: Path to Json file containing annotations from CVAT
    3. `params_path`: Path to params file for the LiDAR sensor detailing transformation needed
    4. `dataset_root`: Root directory to write KITTI-formatted dataset to

- `clustering.py`: Runs clustering according to the DIN SAE Spec on either a provided LiDAR point cloud or simulated LiDAR points in the azimuth/elevation plane.

  Usage: `python3 clustering.py --dataset_path {kitti_data} --save_progress`
    1. `kitti_data`: LiDAR data in the KITTI format that was generated by running `cvat_to_openpcdet.py`. The script will automatically extract the points on the first annotated engineering target in the point cloud and convert them to the azimuth/elevation plane.
    2. `save_progress`: Boolean flag that can be included to save PNG files that visualize each step of the clustering process. These can later be converted to a video with `ffmpeg -framerate 2 -i %04d.png -c:v libx264 -pix_fmt yuv420p out.mp4`

Installation instructions can be found [here](../docs/HASS_SUPPORT.md).